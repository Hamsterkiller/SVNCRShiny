{
    "contents" : "# clearing workspace\nrm(list = ls())\n# loading fact data\nload(\"SVNC_P_V_KOM_FACT.RData\")\nregions <- read.csv('C:/!zemskov/svnc_forecast/data_sources/REGION_NAME.csv'\n                    ,sep = ';', stringsAsFactors = FALSE)\nfact_data <- svnc_p_v_kom\n#rm(svnc_p_v_kom)\ncomp_month <- \"2017-01-01\"\n#fact_data$TDATE <- as.Date(fact_data$TDATE)\nfact_data <- fact_data[fact_data$TDATE == as.Date(comp_month), ]\n#fact_data_filtered <- fact_data[fact_data$TDATE == as.Date(comp_month), \n#      c(\"TDATE\", \"PCODE\", \"TCODE\", \"REGION_CODE\", \"P_VC_UNREG_AVG\", \"P_NC_UNREG_AVG\")]\nfact_data$N_COST <- fact_data$P_NC_UNREG_AVG * fact_data$PIKE_FACT\nfact_data$EE_COST <- fact_data$P_VC_UNREG_AVG * fact_data$VOLUME\nfact_data_filtered <- fact_data[, c(\"TDATE\", \"PCODE\", \"REGION_CODE\", \"N_COST\", \n                                    \"EE_COST\", \"PIKE_FACT\", \"VOLUME\")]\nlibrary(dplyr)\nfact_data_grouped <- summarize(group_by(fact_data_filtered, TDATE, PCODE,  REGION_CODE), \n                               SVNC_M_FACT = sum(N_COST)/sum(PIKE_FACT), \n                               SVNC_EE_FACT = sum(EE_COST)/sum(VOLUME))\nfact_data_grouped <- fact_data_grouped[, c(\"PCODE\", \"REGION_CODE\", \"SVNC_M_FACT\", \"SVNC_EE_FACT\")]\nfact_data_grouped$REGION_CODE <- as.numeric(fact_data_grouped$REGION_CODE)\nfact_data_grouped$PCODE <- as.character(trimws(fact_data_grouped$PCODE, which = \"both\"))\n# loading forecasts\nlibrary(xlsx)\nfcst_data <- read.xlsx(file = \"C:/!zemskov/svnc_forecast/data_sources/january_2017_quality_report(weighted).xlsx\", \n                       sheetName = \"SVNC_M_ee\", encoding = 'UTF-8')\n# names(fcst_data) <- c('id', 'PCODE', 'REGION_NAME', 'PRICE_N', 'PRICE_EE')\n# fcst_data$PCODE <- as.character(trimws(fcst_data$PCODE, which = \"both\"))\n# fcst_data$REGION_NAME <- as.character(trimws(fcst_data$REGION_NAME, which = \"both\"))\n\n# fcst_data <- merge(fcst_data, regions[, c('REG', 'REG_NAME')], \n#                    by.x = c('REGION_NAME'), by.y = c('REG_NAME'), all.x = TRUE)\n# fcst_data <- select(fcst_data, PCODE, REG, REGION_NAME, PRICE_EE, PRICE_N)\n# names(fcst_data) <- c('PCODE', 'REGION_CODE', 'REGION_NAME', 'PRICE_EE', 'PRICE_N')\nfcst_data$REGION_CODE <- as.numeric(as.character(fcst_data$REGION_CODE))\n#fcst_data <- fcst_data[, c(\"PCODE\", \"REGION_CODE\", \"PRICE\")]\nplan_fact <- merge(fcst_data, fact_data_grouped, \n                   by = c('PCODE', 'REGION_CODE'), all.x = TRUE, sort = TRUE)\nquality <- na.omit(plan_fact)\nquality$error_M <- quality$PRICE_N - quality$SVNC_M_FACT\nquality$abs_error_M <- abs(quality$PRICE_N - quality$SVNC_M_FACT)\nquality$pcnt_error_M <- quality$abs_error_M / quality$SVNC_M_FACT * 100\nquality$MAE_M <- mean(quality$abs_error_M)\nquality$MAE_pcnt_M <- mean(quality$pcnt_error_M)\nquality$median_error_M <- median(quality$abs_error_M)\nquality$pcnt_median_error_M <- median(quality$pcnt_error_M)\n\nquality$error_EE <- quality$PRICE_EE - quality$SVNC_EE_FACT\nquality$abs_error_EE <- abs(quality$PRICE_EE - quality$SVNC_EE_FACT)\nquality$pcnt_error_EE <- quality$abs_error_EE / quality$SVNC_EE_FACT * 100\nquality$MAE_EE <- mean(quality$abs_error_EE)\nquality$MAE_pcnt_EE <- mean(quality$pcnt_error_EE)\nquality$median_error_EE <- median(quality$abs_error_EE)\nquality$pcnt_median_error_EE <- median(quality$pcnt_error_EE)\nwrite.xlsx(quality, \"january_2017_quality_report(weighted).xlsx\")\n",
    "created" : 1485782954027.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1210551833",
    "id" : "48C243F7",
    "lastKnownWriteTime" : 1488444033,
    "path" : "C:/!zemskov/svnc_forecast/quality_analysis.R",
    "project_path" : "quality_analysis.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "type" : "r_source"
}